% !TEX program = LuaLaTeX
\DocumentMetadata{lang=en,testphase=latest,uncompress,
  pdfstandard=UA-1,pdfversion=1.7, % passes PAC, VeraPDF
%  pdfstandard=UA-2,pdfversion=2.0, % passes VeraPDF
%  pdfstandard=A-4, % fails VeraPDF
%  pdfstandard=A-4F, % passes VeraPDF
}
\documentclass{article}
\usepackage{multirow}
\usepackage{table-header-classmap}
%\usepackage{table-header-scope}
\usepackage{bookmark}
\title{Title}
\setlength{\parskip}{\baselineskip}
\begin{document}

\section{Simple cases}
one row with one unheadered cell:\\
\tagpdfsetup{table/header-columns={2}}
\begin{tabular}{ccc}
a&B&c
\end{tabular}

one row, lots of header columns:\\
\tagpdfsetup{table/header-columns={1,2,4,-1,-2,-4}}
\begin{tabular}{ccccccccc}
A&B&c&D&e&F&g&H&I
\end{tabular}

one column, lots of header rows:\\
\tagpdfsetup{table/header-rows={1,2,4,-1,-2,-4},table/header-columns={}}
\begin{tabular}{c}
A\\B\\c\\D\\e\\F\\g\\H\\I
\end{tabular}

simple header row and column:\\
\tagpdfsetup{table/header-rows={1,-1},table/header-columns={1,-1}}
\begin{tabular}{cccc}
NW&N1&N2&NE\\
W1 & 1-1& 1-2&E1 \\
W2 & 2-1 & 2-2 &E2\\
SW&S1&S2&SE
\end{tabular}

\section{Multicol}
multicol in header:\\
\tagpdfsetup{table/header-columns={1,-1},table/header-rows={1,2,-1,-2}}
\begin{tabular}{|c|c|c|c|c|}\hline
NW&\multicolumn{3}{|c|}{N1--3}&NE \\\hline
NW2& N2 & N3 & N4 & NE2\\\hline
W1 & 1-1 & 1-2 & 1-3 & E1 \\\hline
W2 & 2-1 & 2-2 & 2-3 & E2 \\\hline
SW& S2 & S3 & S4 &SE\\\hline
SW2&\multicolumn{3}{|c|}{S1--3}&SE2\\\hline
\end{tabular}

multicol in data:\\
\tagpdfsetup{table/header-rows={1,-1},table/header-columns={1,-1}}
\begin{tabular}{|c|c|c|c|c|c|}\hline
NW&N1&N2&N3&N4&NE\\\hline
W1 & 1-1& \multicolumn{3}{|c|}{1-(2--4)} & E1\\\hline
W2 & 2-1 & 2-2 & 2-3 & 2-4 & E2 \\\hline
SW&S1&S2&S3&S4&SE\\\hline
\end{tabular}

overlapping multicol:\\
\tagpdfsetup{table/header-rows={1,-1},table/header-columns={1,-1}}
\begin{tabular}{|c|c|c|c|c|}\hline
NW&N1&\multicolumn{2}{|c|}{N2.5}&NE\\\hline
W1&\multicolumn{2}{|c|}{1-1.5}&1-3&E1\\\hline
W2&2-1&2-2&2-3&E2\\\hline
SW&S1&\multicolumn{2}{|c|}{S2.5}&SE\\\hline
\end{tabular}

\end{document}

\section{Multirow fails}
multirow in header:\\
\tagpdfsetup{table/header-columns={1,2,-1,-2},table/header-rows={1,-1}}
\begin{tabular}{|c|c|c|c|c|c|}\hline
NW&NW2& N1 & N2 &NE&NE2\\\hline
\tagpdfsetup{table/multirow={2}}\multirow{2}{*}{W1.5} & W3 & 1-1 & 1-2 & E3 & \tagpdfsetup{table/multirow={2}}\multirow{2}{*}{E1.5}\\\cline{2-5}
& W4 & 2-1 & 2-2 & E4 & \\\hline
SW&SW2& S1 & S2 & SE & SE2\\\hline
\end{tabular}

multirow in data:\\
\tagpdfsetup{table/header-rows={1,-1},table/header-columns={1,-1}}
\begin{tabular}{|c|c|c|c|c|}\hline
NW&N1&N2&N3&NE\\\hline
W1 & 1-1& \tagpdfsetup{table/multirow={2}}\multirow{2}{*}{1.5-2} & 1-3 & E1\\\cline{1-2}\cline{4-5}
W2 & 2-1 & & 2-3 & E2 \\\hline
SW&S1&S2&S3&SE\\\hline
\end{tabular}

overlapping multirow:\\
\tagpdfsetup{table/header-columns={1,-1},table/header-rows={1,-1}}
\begin{tabular}{|c|c|c|c|}\hline
NW&N1&N2&NE\\\hline
\tagpdfsetup{table/multirow={2}}\multirow{2}{*}{W1.5}&1-1&1-2&\tagpdfsetup{table/multirow={2}}\multirow{2}{*}{E1.5}\\\cline{2-3}
&\tagpdfsetup{table/multirow={2}}\multirow{2}{*}{2.5-1}&2-2&\\\cline{1-1}\cline{3-4}
W3&&3-2&E3\\\hline
SW&S1&S2&SE\\\hline
\end{tabular}

\end{document}
