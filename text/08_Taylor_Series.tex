\section{Taylor Series}\label{sec:taylor_series}

In \autoref{sec:power_series}, we showed how certain functions can be represented by a power series function. In \autoref{sec:taylor_poly}, we showed how we can approximate functions with polynomials, given that enough derivative information is available. In this section we combine these concepts: if a function $f(x)$ is infinitely differentiable, we show how to represent it with a power series function.

\begin{definition}[Taylor and Maclaurin Series]\label{def:taylor_series}
Let $f(x)$ have derivatives of all orders at $x=c$.
\index{Taylor Series!definition}\index{Maclaurin Series!definition}\index{Maclaurin Series|seealso{Taylor Series}}\index{series!Taylor}\index{series!Maclaurin}
\begin{enumerate}
	\item The \textbf{Taylor Series of $f(x)$, centered at $c$} is
	\[\sum_{n=0}^\infty \frac{f\,^{(n)}(c)}{n!}(x-c)^n.\]
	\item	Setting $c=0$ gives the \textbf{Maclaurin Series of $f(x)$}:
	\[\sum_{n=0}^\infty \frac{f\,^{(n)}(0)}{n!}x^n.\]
\end{enumerate}
\end{definition}

\youtubeVideo{Os8OtXFBLkY}{Taylor and Maclaurin Series --- Example 2}

The difference between a Taylor polynomial and a Taylor series is the former is a polynomial, containing only a finite number of terms, whereas the latter is a series, a summation of an infinite set of terms. When creating the Taylor polynomial of degree $n$ for a function $f(x)$ at $x=c$, we needed to evaluate $f$, and the first $n$ derivatives of $f$, at $x=c$. When creating the Taylor series of $f$, we need to find a pattern that describes the $n^\text{th}$ derivative of $f$ at $x=c$. We demonstrate this in the next two examples.

\begin{example}[The Maclaurin series of $f(x) = \cos x$]\label{ex_ts1}
Find the Maclaurin series of $f(x)=\cos x$.
\solution
In \autoref{ex_taypoly4} we found the $8^\text{th}$ degree Maclaurin polynomial of $\cos x$. In doing so, we created the table shown in \autoref{fig:ts1}.
%
\mtable{A table of the derivatives of $f(x)=\cos x$ evaluated at $x=0$.}{fig:ts1}{%
\begin{align*}
f(x) &= \phantom-\cos x &\Rightarrow & &f(0) &= \phantom-1\\
\fp(x) &= -\sin x &\Rightarrow & &\fp(0) &= \phantom-0\\
\fp'(x) &= -\cos x &\Rightarrow & &\fp'(0) &= -1\\
\fp''(x) &= \phantom-\sin x &\Rightarrow & &\fp''(0) &= \phantom-0\\
f\,^{(4)}(x) &= \phantom-\cos x &\Rightarrow & &f\,^{(4)}(0) &= \phantom-1\\
f\,^{(5)}(x) &= -\sin x &\Rightarrow & &f\,^{(5)}(0) &= \phantom-0\\
f\,^{(6)}(x) &= -\cos x &\Rightarrow & &f\,^{(6)}(0) &= -1\\
f\,^{(7)}(x) &= \phantom-\sin x &\Rightarrow & &f\,^{(7)}(0) &= \phantom-0\\
f\,^{(8)}(x) &= \phantom-\cos x &\Rightarrow & &f\,^{(8)}(0) &= \phantom-1\\
f\,^{(9)}(x) &= -\sin x &\Rightarrow & &f\,^{(9)}(0) &= \phantom-0
\end{align*}}
%
Notice how $f\,^{(n)}(0)=0$ when $n$ is odd,  $f\,^{(n)}(0)=1$ when $n$ is divisible by $4$, and $f\,^{(n)}(0)=-1$ when $n$ is even but not divisible by 4. Thus the Maclaurin series of $\cos x$ is
\[1-\frac{x^2}2+\frac{x^4}{4!}-\frac{x^6}{6!}+\frac{x^8}{8!} - \dotsb\]
We can go further and write this as a summation. Since we only need the terms where the power of $x$ is even, we write the power series in terms of $x^{2n}$:
\[\sum_{n=0}^\infty (-1)^{n}\frac{x^{2n}}{(2n)!}.\]
\end{example}

\begin{example}[The Taylor series of $f(x)=\ln x$ at $x=1$]\label{ex_ts2}
Find the Taylor series of $f(x) = \ln x$ centered at $x=1$.
\solution
\autoref{fig:ts2} shows the $n^\text{th}$ derivative of $\ln x$ evaluated at $x=1$ for $n=0,\dotsc,5$, along with an expression for the $n^\text{th}$ term:
\[f\,^{(n)}(1) = (-1)^{n+1}(n-1)!\quad \text{for $n\geq 1$.}\]
Remember that this is what distinguishes Taylor series from Taylor polynomials; we are very interested in finding a pattern for the $n^\text{th}$ term, not just finding a finite set of coefficients for a polynomial.
\mtable{Derivatives of $\ln x$ evaluated at $x=1$.}{fig:ts2}{%
\begin{align*}
% todo Tim latexml https://github.com/brucemiller/LaTeXML/issues/1763
f(x) &= \makebox[3em]{$\ln x$} \quad \Rightarrow & f(1)&=\phantom-0\\
\fp(x) &= \makebox[3em]{$\phantom-1/x$} \quad \Rightarrow & \fp(1) &= \phantom-1\\
\fp'(x) &= \makebox[3em]{$-1/x^2$} \quad \Rightarrow & \fp'(1) &= -1\\
\fp''(x) &= \makebox[3em]{$\phantom-2/x^3$} \quad \Rightarrow & \fp''(1) &= \phantom-2\\
f\,^{(4)}(x) &= \makebox[3em]{$-6/x^4$} \quad \Rightarrow & f\,^{(4)}(1) &= -6\\
f\,^{(5)}(x) &= \makebox[3em]{$24/x^5$} \quad\Rightarrow  &f\,^{(5)}(1) &= 24\\
\vdots && \vdots & \\
f\,^{(n)}(x) &= \makebox[3em]{}\quad \Rightarrow & f\,^{(n)}(1) &= \smallskip\\
\makebox[1pt]{$\dfrac{(-1)^{n+1}(n-1)!}{x^n}$} && \makebox[1pt]{$(-1)^{n+1}(n-1)!$} &
%f(x) &= \ln x &\Rightarrow & &f(1) &= \phantom-0\\
%\fp(x) &= \phantom-1/x &\Rightarrow & &\fp(1) &= \phantom-1\\
%\fp'(x) &= -1/x^2 &\Rightarrow & &\fp'(1) &= -1\\
%\fp''(x) &= \phantom-2/x^3 &\Rightarrow & &\fp''(1) &= \phantom-2\\
%f\,^{(4)}(x) &= -6/x^4 &\Rightarrow & &f\,^{(4)}(1) &= -6\\
%f\,^{(5)}(x) &= 24/x^5 &\Rightarrow & &f\,^{(5)}(1) &= 24\\
%\ \vdots & & & & \ \vdots & \\
%f\,^{(n)}(x) &=  &\Rightarrow & & f\,^{(n)}(1) &= \smallskip\\
%\makebox[1pt]{$\dfrac{(-1)^{n+1}(n-1)!}{x^n}$} &&&& \makebox[1pt]{$(-1)^{n+1}(n-1)!$} &
\end{align*}}
Since $f(1) = \ln 1 = 0$, we skip the first term and start the summation with $n=1$, giving the Taylor series for $\ln x$, centered at $x=1$, as 
\[\sum_{n=1}^\infty (-1)^{n+1}(n-1)!\frac{1}{n!}(x-1)^n = \sum_{n=1}^\infty (-1)^{n+1}\frac{(x-1)^n}{n}.\]
\end{example}

It is important to note that \autoref{def:taylor_series} defines a Taylor series given a function $f(x)$; however, we \emph{cannot} yet state that $f(x)$ \emph{is equal} to its Taylor series. We will find that ``most of the time'' they are equal, but we need to consider the conditions that allow us to conclude this.

\autoref{thm:taylorthm} states that the error between a function and its $n^\text{th}$-degree Taylor polynomial is $R_n(x)$, where
\[\abs{R_n(x)}\leq \frac{\max\abs{\,f\,^{(n+1)}(z)}}{(n+1)!}\abs{x-c}^{n+1}.\]

If $R_n(x)$ goes to 0 for each $x$ in an interval $I$ as $n$ approaches infinity, we conclude that the function is equal to its Taylor series expansion.

\begin{theorem}[Function and Taylor Series Equality]\label{thm:function_series_equality}
Let $f(x)$ have derivatives of all orders at $x=c$, let $R_n(x)$ be as stated in \autoref{thm:taylorthm}, and let $I$ be an interval on which the Taylor series of $f(x)$ converges. 
If $\ds\lim_{n\to\infty} R_n(x) = 0$ for all $x$ in $I$, then 
\index{Taylor Series!equality with generating function}
\[f(x) = \sum_{n=0}^\infty \frac{f\,^{(n)}(c)}{n!}(x-c)^n\ \text{ on $I$.}\]
\end{theorem}

We demonstrate the use of this theorem in an example.

\begin{example}[Establishing equality of a function and its Taylor series]\label{ex_ts3}
Show that, for all $x$, $f(x) = \cos x$ is equal to its Maclaurin series as found in \autoref{ex_ts1}.
\solution
Given a value $x$, the magnitude of the error term $R_n(x)$ is bounded by
\[\abs{R_n(x)}\leq \frac{\max\abs{\,f\,^{(n+1)}(z)}}{(n+1)!}\abs{x}^{n+1}.\]
Since all derivatives of $\cos x$ are $\pm \sin x$ or $\pm\cos x$, whose magnitudes are bounded by $1$, we can state
\[\abs{R_n(x)}\leq \frac{1}{(n+1)!}\abs{x}^{n+1}\]
which implies
\begin{equation*}
 -\frac{\abs{x}^{n+1}}{(n+1)!} \leq R_n(x) \leq\frac{\abs{x}^{n+1}}{(n+1)!}.%\label{eq:coseqtaylor}
\end{equation*}
For any $x$, $\ds\lim_{n\to\infty} \frac{x^{n+1}}{(n+1)!} = 0$. Applying the Squeeze Theorem to our last inequality%\autoeqref{eq:coseqtaylor}
, we conclude that $\ds \lim_{n\to\infty} R_n(x) = 0$ for all $x$, and hence
\[\cos x = \sum_{n=0}^\infty (-1)^{n}\frac{x^{2n}}{(2n)!}\quad \text{for all $x$}.\]
\end{example}

It is natural to assume that a function is  equal to its Taylor series on the series' interval of convergence, but this is not necessarily the case. In order to properly establish equality, one must use \autoref{thm:function_series_equality}. This is a bit disappointing, as we developed beautiful techniques for determining the interval of convergence of a power series, and proving that $R_n(x)\to 0$ can be cumbersome as it deals with high order derivatives of the function.

There is good news. A function $f(x)$ that is equal to its Taylor series, centered at any point the domain of $f(x)$, is said to be an \textbf{analytic function},\index{analytic function} and most, if not all, functions that we encounter within this course are analytic functions. Generally speaking, any function that one creates with elementary functions (polynomials, exponentials, trigonometric functions, etc.) that is not piecewise defined is probably analytic. For most functions, we assume the function is equal to its Taylor series on the series' interval of convergence and only use \autoref{thm:function_series_equality} when we suspect something may not work as expected.  The converse is also true: if a function is equal to \emph{some} power series on an interval, then that power series is the Taylor series of the function.

We develop the Taylor series for one more important function, then give a table of the Taylor series for a number of common functions.\index{Binomial Series}\index{series!Binomial}

\begin{example}[The Binomial Series]\label{ex_ts4}
Find the Maclaurin series of $f(x) = (1+x)^k$, $k\neq 0$.
\solution
When $k$ is a positive integer, the Maclaurin series is finite. For instance, when $k=4$, we have 
\[f(x) = (1+x)^4 = 1+4x+6x^2+4x^3+x^4.\]
The coefficients of $x$ when $k$ is a positive integer are known as the \emph{binomial coefficients}, giving the series we are developing its name.

When $k=1/2$, we have $f(x) = \sqrt{1+x}$. Knowing a series representation of this function would give a useful way of approximating $\sqrt{1.3}$, for instance.

To develop the Maclaurin series for $f(x) = (1+x)^k$ for any value of $k\neq0$, we consider the derivatives of $f$ evaluated at $x=0$:
{%
\small%
\begin{align*}
f(x) &= (1+x)^k & f(0) &= 1\\
\fp(x) &= k(1+x)^{k-1} & \fp(0) &=k\\
\fp'(x) &= k(k-1)(1+x)^{k-2} & \fp'(0) &=k(k-1)\\
\fp''(x) &= k(k-1)(k-2)(1+x)^{k-3} & \fp''(0) &=k(k-1)(k-2)\\
&\vdots & &\vdots\\
f\,^{(n)}(x) &= k(k-1)\dotsm\bigl(k-(n-1)\bigr)(1+x)^{k-n}
\mkern-3\thickmuskip&&\vdots \\
&& f\,^{(n)}(0) &=k(k-1)\dotsm\bigl(k-(n-1)\bigr)
\end{align*}}%
Thus the Maclaurin series for $f(x) = (1+x)^k$ is
\[
1+ kx + \frac{k(k-1)}{2!}x^2 + \frac{k(k-1)(k-2)}{3!}x^3 + \dotsb + \frac{k(k-1)\dotsm\bigl(k-(n-1)\bigr)}{n!}x^n+\dotsb
\]

It is important to determine the interval of convergence of this series. With 
\[a_n = \frac{k(k-1)\dotsm\bigl(k-(n-1)\bigr)}{n!}x^n,\]
we apply the Ratio Test:
\begin{align*}
	\lim_{n\to\infty}\frac{\abs{a_{n+1}}}{\abs{a_n}}
	&=\lim_{n\to\infty}\frac{\abs{\frac{k(k-1)\dotsm(k-n)}{(n+1)!}x^{n+1}}}{\abs{\frac{k(k-1)\dotsm\bigl(k-(n-1)\bigr)}{n!}x^n}}\\
		&=\lim_{n\to\infty} \abs{\frac{k-n}{n+1}x}\\
		&= \abs x.
\end{align*}

The series converges absolutely when the limit of the Ratio Test is less than 1; therefore, we have absolute convergence when $\abs x<1$. 

While outside the scope of this text, the interval of convergence depends on the value of $k$. When $k>0$, the interval of convergence is $[-1,1]$. When $-1<k<0$, the interval of convergence is $(-1,1]$. If $k\leq -1$, the interval of convergence is $(-1,1)$.
%When $x=1$, we can apply the Alternating Series Test and find the series converges. When $x=-1$, it can be shown (with some difficulty) that the series also converges. Therefore the interval of convergence is $[-1,1]$. We can apply \autoref{thm:function_series_equality} to prove equality between $f(x)$ and the series (or apply the discussion following the theorem). 
\end{example}

We learned that Taylor polynomials offer a way of approximating a ``difficult to compute'' function with a polynomial. Taylor series offer a way of exactly representing a function with a series. One probably can see the use of a good approximation; is there any use of representing a function exactly as a series?

While we appreciate the mathematical beauty of Taylor series (which is reason enough to study them), there are practical uses as well. They provide a valuable tool for solving a variety of problems, including problems relating to integration and differential equations.

In \autoref{idea:common_taylor} (on the following page) we give  a table of the Maclaurin series of a number of common functions. We then give a theorem about the ``algebra of power series,'' that is, how we can combine power series to create power series of new functions. This allows us to find the Taylor series of functions like $f(x) = e^x\cos x$ by knowing the Taylor series of $e^x$ and $\cos x$.

Before we investigate combining functions, consider the Taylor series for the arctangent function (see \autoref{idea:common_taylor}). Knowing that $\tan^{-1}(1) = \pi/4$, we can use this series to approximate the value of $\pi$:
\begin{align*}
\frac{\pi}4 &= \tan^{-1}(1) = 1-\frac13+\frac15-\frac17+\frac19-\dotsb\\
\pi &= 4\left(1-\frac13+\frac15-\frac17+\frac19-\dotsb\right)
\end{align*} 
Unfortunately, this particular expansion of $\pi$ converges very slowly. The first 
100 terms approximate $\pi$ as $3.13159$, which is not particularly good.

{
\tcbset{grow to right by=12em}
\begin{keyidea}[Important Maclaurin Series Expansions]\label{idea:common_taylor}
%
\noindent\begin{tabular}{llc}
\textbf{Function and Series} & \textbf{First Few Terms} & \parbox{55pt}{\centering\textbf{Interval of}\\\textbf{Convergence}} \\
$\ds e^x = \sum_{n=0}^\infty \frac{x^n}{n!}$ & $\ds 1+ x+\frac{x^2}{2!} + \frac{x^3}{3!}+\dotsb$ & $(-\infty,\infty)$\medskip\\ % Ex {ex_taypoly1} (ish) 9.9.1
$\ds \sin x = \sum_{n=0}^\infty (-1)^n\frac{x^{2n+1}}{(2n+1)!}$ & $\ds x-\frac{x^3}{3!}+\frac{x^5}{5!} - \frac{x^7}{7!}+\dotsb$ & $(-\infty,\infty)$\medskip\\
$\ds \cos x = \sum_{n=0}^\infty (-1)^n\frac{x^{2n}}{(2n)!}$ & $\ds 1-\frac{x^2}{2!}+\frac{x^4}{4!} - \frac{x^6}{6!} +\dotsb$ & $(-\infty,\infty)$\smallskip\\ % ex {ex_ts1} 9.10.1
$\ds \ln(x+1) = \sum_{n=1}^\infty(-1)^{n+1}\frac{x^n}{n}$ & $\ds x-\frac{x^2}{2}+\frac{x^3}{3}-\dotsb$& $(-1,1]$\smallskip\\ % Ex 9.10.2 (ish)
$\ds \frac{1}{1-x} = \sum_{n=0}^\infty x^n$ &$\ds 1+x+x^2+x^3+\dotsb$& $(-1,1)$\\ % equ {eq:power_series_geometric} 9.8.1
\small$\ds (1+x)^k=\sum_{n=0}^\infty \frac{k(k-1)\dotsm\bigl(k-(n-1)\bigr)}{n!}x^n$ \normalsize& $\ds 1+kx+\frac{k(k-1)}{2!}x^2 + \dotsb$ & {$\begin{cases}(-1,1)&\phantom{-}k\le-1\\{}(-1,1]&-1<k<0\\{}[-1,1]&\phantom{-}0<k\end{cases}$}\\ % ex {ex_ts4} 9.10.4
$\ds \tan^{-1}x = \sum_{n=0}^\infty (-1)^n\frac{x^{2n+1}}{2n+1}$ & $\ds x-\frac{x^3}{3}+\frac{x^5}{5}-\frac{x^7}{7}+\dotsb$ & $[-1,1]$
\end{tabular}\index{Taylor Series!common series}
\end{keyidea}
}

% todo Tim should we mention where in the text we derive the ``Important Maclaurin Series Expansions''
% todo Tim Do we want to derive the Maclaurin series for sin and arctan?

\begin{theorem}[Algebra of Power Series]\label{thm:series_alg}
Let $\ds f(x) = \sum_{n=0}^\infty a_nx^n$ and $\ds g(x) = \sum_{n=0}^\infty b_nx^n$ converge absolutely for $\abs x<R$, and let $h(x)$ be continuous.
\index{power series!algebra of} 
\begin{enumerate}
	\item	$\ds f(x)\pm g(x) = \sum_{n=0}^\infty (a_n\pm b_n)x^n$ \quad for $\abs x<R$.
	\item	$\ds f(x)g(x) = \left(\sum_{n=0}^\infty a_nx^n\right)\left(\sum_{n=0}^\infty b_nx^n\right) =\\
	\mbox{}\qquad
	\sum_{n=0}^\infty\bigl(a_0b_n+a_1b_{n-1}+\dotsb+ a_nb_0\bigr)x^n$ for $\abs x<R$.
	\item	$\ds f\bigl(h(x)\bigr) = \sum_{n=0}^\infty a_n\bigl(h(x)\bigr)^n$ \quad for $\abs{h(x)}<R$.
\end{enumerate}
\end{theorem}

\begin{example}[Combining Taylor series]\label{ex_ts5}
Write out the first 3 terms of the Maclaurin Series for $f(x) = e^x\cos x$ using \autoref{idea:common_taylor} and \autoref{thm:series_alg}.
\solution
\autoref{idea:common_taylor} informs us that 
\[e^x = 1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\dotsb\qquad \text{and}\qquad \cos x = 1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dotsb.\]
Applying \autoref{thm:series_alg}, we find that
\begin{align*}
e^x\cos x &= \left(1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\dotsb\right)\left(1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dotsb\right).
\intertext{Distribute the right hand expression across the left:}
	&= 1\left(1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dotsb\right)
	+x\left(1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dotsb\right)\\
	&\phantom{=}+\frac{x^2}{2!}\left(1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dotsb\right)
	+\frac{x^3}{3!}\left(1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dotsb\right)\\
	&\phantom{=}+ \frac{x^4}{4!}\left(1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dotsb\right)+\dotsb
	\intertext{Distribute again and collect like terms.}
	&= 1 + x -\frac{x^3}{3}-\frac{x^4}{6} - \frac{x^5}{30}+\frac{x^7}{630}+\dotsb
\end{align*}
While this process is a bit tedious, it is much faster than evaluating all the necessary derivatives of $e^x\cos x$ and computing the Taylor series directly.

Because the series for $e^x$ and $\cos x$ both converge on $(-\infty,\infty)$, so does the series expansion for $e^x\cos x$.
\end{example}

\begin{example}[Creating new Taylor series]\label{ex_ts6}
Use \autoref{thm:series_alg} to create the Taylor series for $y=\sin(x^2)$ centered at $x=0$ and a series for $y=\ln (\sqrt{x})$ centered at $c=1$.
\solution
Given that 
\[\sin x = \sum_{n=0}^\infty (-1)^n\frac{x^{2n+1}}{(2n+1)!} = x-\frac{x^3}{3!}+\frac{x^5}{5!} -\frac{x^7}{7!}+\dotsb,\]
we simply substitute $x^2$ for $x$ in the series, giving
\[
\sin (x^2) = \sum_{n=0}^\infty (-1)^n\frac{(x^2)^{2n+1}}{(2n+1)!} = \sum_{n=0}^\infty (-1)^n\frac{x^{4n+2}}{(2n+1)!} = x^2-\frac{x^6}{3!}+\frac{x^{10}}{5!} -\frac{x^{14}}{7!}\dotsb.
\]
Since the Taylor series for $\sin x$ has an infinite radius of convergence, so does the Taylor series for $\sin(x^2)$.\bigskip

The Taylor expansion for $\ln(x+1)$ given in \autoref{idea:common_taylor} is centered at $x=0$, so we can center the series for $\ln (\sqrt{x})$ at $x=1$.
With 
\[\ln x = \sum_{n=1}^\infty(-1)^{n+1}\frac{(x-1)^n}{n} = (x-1)- \frac{(x-1)^2}{2} +\frac{(x-1)^3}{3}-\dotsb,\]
\mnote{\textbf{Note:} In \autoref{ex_ts6}, one could create a series for $\ln(\sqrt{x})$ by simply recognizing that $\ln(\sqrt{x}) = \ln (x^{1/2}) = 1/2\ln x$, and hence multiplying the Taylor series for $\ln x$ by $1/2$. This example was chosen to demonstrate other aspects of series, such as the fact that the interval of convergence changes.}
we substitute $\sqrt{x}$ for $x$ to obtain
\[\ln (\sqrt{x}) = \sum_{n=1}^\infty(-1)^{n+1}\frac{(\sqrt{x}-1)^n}{n} = (\sqrt{x}-1)- \frac{(\sqrt{x}-1)^2}{2} +\frac{(\sqrt{x}-1)^3}{3}-\dotsb.\]
While this is not strictly a power series because of the $\sqrt x$, it is a series that allows us to study the function $\ln(\sqrt{x})$. Since the interval of convergence of $\ln x$ is $(0,2]$, and the range of $\sqrt{x}$ on $(0,4]$ is $(0,2]$, the interval of convergence of this series expansion of $\ln(\sqrt{x})$ is $(0,4]$.
\end{example}

\begin{example}[Using Taylor series to evaluate definite integrals]\label{ex_ts7}
Use the Taylor series of $e^{-x^2}$ to evaluate $\ds \int_0^1e^{-x^2}\dd x$.
\solution
We learned, when studying Numerical Integration, that $e^{-x^2}$ does not have an antiderivative expressible in terms of elementary functions. This means any definite integral of this function must have its value approximated, and not computed exactly.

We can quickly write out the Taylor series for $e^{-x^2}$ using the Taylor series of $e^x$:\vspace{-.5\baselineskip}
\begin{align*}
e^x &= \sum_{n=0}^\infty \frac{x^n}{n!} = 1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\dotsb
\intertext{and so}
e^{-x^2} &= \sum_{n=0}^\infty \frac{(-x^2)^n}{n!} \\
				&= \sum_{n=0}^\infty (-1)^n\frac{x^{2n}}{n!}\\
				&= 1-x^2+\frac{x^4}{2!}-\frac{x^6}{3!}+\dotsb.
\end{align*}
We use \autoref{thm:calc_power_series} to integrate:
\[\int e^{-x^2}\dd x = C + x - \frac{x^3}{3}+\frac{x^5}{5\cdot2!}-\frac{x^7}{7\cdot3!}+\dotsb +(-1)^n\frac{x^{2n+1}}{(2n+1)n!}+\dotsb\]
This \emph{is} the antiderivative of $e^{-x^2}$; while we can write it out as a series, we cannot write it out in terms of elementary functions. We can evaluate the definite integral $\ds \int_0^1e^{-x^2}\dd x$ using this antiderivative; substituting 1 and 0 for $x$ and subtracting gives
\[\int_0^1e^{-x^2}\dd x = 1-\frac{1}{3}+\frac{1}{5\cdot 2!}-\frac{1}{7\cdot3!} + \frac{1}{9\cdot4!}-\dotsb.\]
Summing the 5 terms shown above gives the approximation of $0.74749.$ Since this is an alternating series, we can use the Alternating Series Approximation Theorem, (\autoref{thm:alt_series_approx}), to determine how accurate this approximation is. The next term of the series is $ 1/(11\cdot5!) \approx 0.00075758$. Thus we know our approximation is within $0.00075758$ of the actual value of the integral. This is arguably much less work than using Simpson's Rule to approximate the value of the integral.
\end{example}

Another advantage to using Taylor series instead of Simpson's Rule is for making subsequent approximations.  We found in \autoref{ex_num7} that the error in using Simpson's Rule for $\ds\int_0^1 e^{-x^2}\dd x$ with four intervals was $0.00026$.  If we wanted to decrease that error, we would need to use more intervals, essentially starting the problem over.  Using a Taylor series, if we wanted a more accurate approximation, we can just subtract the next term $1/(11\cdot5!)$ to get an approximation of $0.7467$, with an error of at most $1/(13\cdot6!)\approx0.0001$.\bigskip

%\begin{example}[Using Taylor series to solve differential equations]\label{ex_ts8}
%Solve the differential equation $y\primeskip'=2y$ in terms of a power series, and use the theory of Taylor series to recognize the solution in terms of an elementary function.
%\solution
%We found the first 5 terms of the power series solution to this differential equation in \autoref{ex_ps5} in \autoref{sec:power_series}. These are:
%\[a_0=1,\quad a_1 = 2,\quad a_2 = \frac42=2,\quad a_3=\frac{8}{2\cdot3}=\frac43,\quad a_4=\frac{16}{2\cdot3\cdot4} = \frac23.\]
%We include the ``unsimplified'' expressions for the coefficients found in \autoref{ex_ps5} as we are looking for a pattern. It can be shown that $a_n = 2^n/n!$. Thus the solution, written as a power series, is
%\[y = \sum_{n=0}^\infty \frac{2^n}{n!}x^n = \sum_{n=0}^\infty \frac{(2x)^n}{n!}.\]
%Using \autoref{idea:common_taylor} and \autoref{thm:series_alg}, we recognize $f(x) = e^{2x}$:
%\[e^x = \sum_{n=0}^\infty \frac{x^n}{n!} \qquad \Rightarrow \qquad e^{2x} = \sum_{n=0}^\infty \frac{(2x)^n}{n!}.\]
%\end{example}

Finding a pattern in the coefficients that match the series expansion of a known function, such as those shown in \autoref{idea:common_taylor}, can be difficult. What if the coefficients %in the previous example were
are given in their reduced form; how could we still recover the function?% $y=e^{2x}$?

Suppose that all we know is that 
\[a_0=1,\quad a_1=2,\quad a_2=2,\quad a_3=\frac43,\quad a_4=\frac23.\]
\autoref{def:taylor_series} states that each term of the Taylor expansion of a function includes an $n!$. This allows us to say that
\[a_2=2=\frac{b_2}{2!},\quad a_3 = \frac43=\frac{b_3}{3!},\quad \text{and}\quad a_4 = \frac23=\frac{b_4}{4!}\]
for some values $b_2$, $b_3$ and $b_4$.
Solving for these values, we see that $b_2=4$, $b_3 = 8$ and $b_4=16$. That is, we are recovering the pattern $b_n=2^n$, %we had previously seen,
allowing us to write 
\begin{align*}
	f(x) = \sum_{n=0}^\infty a_nx^n
	&= \sum_{n=0}^\infty \frac{b_n}{n!}x^n \\
	&= 1+2x+ \frac{4}{2!}x^2 + \frac{8}{3!}x^3+\frac{16}{4!}x^4 + \dotsb
\end{align*}
From here it is easier to recognize that the series is describing an exponential function.

%There are simpler, more direct ways of solving the differential equation $y\primeskip' = 2y$. We applied power series techniques to this equation to demonstrate its utility, and went on to show how \emph{sometimes} we are able to recover the solution in terms of elementary functions using the theory of Taylor series. Most differential equations faced in real scientific and engineering situations are much more complicated than this one, but power series can offer a valuable tool in finding, or at least approximating, the solution.\bigskip

This chapter introduced sequences, which are ordered lists of numbers, followed by series, wherein we add up the terms of a sequence. We quickly saw that such sums do not always add up to ``infinity,'' but rather converge. We studied tests for convergence, then ended the chapter with a formal way of defining functions based on series. Such ``series-defined functions'' are a valuable tool in solving a number of different problems throughout science and engineering.

Coming in the next chapters are new ways of defining curves in the plane apart from using functions of the form $y=f(x)$. Curves created by these new methods can be beautiful, useful, and important. 

% todo have the exercises find the interval of convergence where appropriate

\printexercises{exercises/08-08-exercises}
