\section{Iterated Integrals and Area}\label{sec:iterated_integrals}

In \autoref{chap:multi} we found that it was useful to differentiate functions of several variables with respect to one variable, while treating all the other variables as constants or coefficients. We can integrate functions of several variables in a similar way. For instance, if we are told that $f_x(x,y) = 2xy$, we can treat $y$ as staying constant and integrate to obtain $f(x,y)$:
\begin{align*}
	f(x,y)
	&= \int f_x(x,y)\ dx\\
	&= \int 2xy\ dx \\
	&= x^2y + C.
\end{align*}
Make a careful note about the constant of integration, $C$. This ``constant'' is something with a derivative of $0$ with respect to $x$, so it could be any expression that contains only constants and functions of $y$. For instance, if $f(x,y) = x^2y+ \sin y + y^3 + 17$, then $f_x(x,y) = 2xy$. To signify that $C$ is actually a function of $y$, we write:
\index{integration!of multivariable functions}
\[f(x,y) = \int f_x(x,y)\ dx  = x^2y+C(y).\]

Using this process we can even evaluate definite integrals.

\begin{example}[Integrating functions of more than one variable]\label{ex_iterated1}
Evaluate the integral $\ds \int_1^{2y} 2xy\ dx$.
\solution
We find the indefinite integral as before, then apply the Fundamental Theorem of Calculus to evaluate the definite integral:
\begin{align*}
 \int_1^{2y} 2xy\ dx
 &= x^2y\Big|_1^{2y}\\
 &= (2y)^2y - (1)^2y \\
 &= 4y^3-y.
\end{align*}
\end{example}

We can also integrate with respect to $y$. In general,
\[\int_{h_1(y)}^{h_2(y)} f_x(x,y)\ dx = f(x,y)\Big|_{h_1(y)}^{h_2(y)} = f\bigl(h_2(y),y\bigr)-f\bigl(h_1(y),y\bigr),\]
and
\[\int_{g_1(x)}^{g_2(x)} f_y(x,y)\ dy = f(x,y)\Big|_{g_1(x)}^{g_2(x)} = f\bigl(x,g_2(x)\bigr)-f\bigl(x,g_1(x)\bigr).\]

Note that when integrating by $x$, the bounds do not depend on $x$, and the result is no longer a function of $x$.  When integrating by $y$, the bounds do not depend on $y$, and the result is no longer a function of $y$. Another example will help us understand this.

\begin{example}[Integrating functions of more than one variable]\label{ex_iterated2}
Evaluate $\ds \int_1^x\bigl(5x^3y^{-3}+6y^2\bigr)\ dy$.
\solution
We consider $x$ as staying constant and integrate with respect to $y$:
\begin{align*}
\int_1^x\bigl(5x^3y^{-3}+6y^2\bigr)\ dy & = \left(\frac{5x^3y^{-2}}{-2}+\frac{6y^3}{3}\right)\Bigg|_1^x \\
						&= \left(-\frac52x^3x^{-2}+2x^3\right) - \left(-\frac52x^3+2\right) \\
						&= \frac92x^3-\frac52x-2.
\end{align*}
Note how the bounds of the integral are from $y=1$ to $y=x$ and that the final answer is a function of $x$.
\end{example}

In the previous example, we integrated a function with respect to $y$ and ended up with a function of $x$. We can integrate this as well. This process is known as \textbf{iterated integration}, or \textbf{multiple integration.}

\youtubeVideo{DYsv6L-VcsQ}{Double Integrals --- Basic Idea and Examples}

\begin{example}[Integrating an integral]\label{ex_iterated3}
Evaluate $\ds \int_1^2\left(\int_1^x\bigl(5x^3y^{-3}+6y^2\bigr)\ dy\right)\ dx$.
\solution
We follow a standard ``order of operations'' and perform the operations inside parentheses first (which is the integral evaluated in \autoref{ex_iterated2}.)
\begin{align*}
\int_1^2\left(\int_1^x\bigl(5x^3y^{-3}+6y^2\bigr)\ dy\right)\ dx &= \int_1^2 \left(\left[\frac{5x^3y^{-2}}{-2}+\frac{6y^3}{3}\right]\Bigg|_1^x\right)\ dx \\
			&= \int_1^2 \left(\frac92x^3-\frac52x-2\right)\ dx \\
			&= \left(\frac98x^4-\frac54x^2-2x\right)\Bigg|_1^2\\
			&= \frac{89}8.
\end{align*}
Note how the bounds of $x$ were $x=1$ to $x=2$ and the final result was a number.
\end{example}

The previous example showed how we could perform something called an iterated integral; we do not yet know \emph{why} we would be interested in doing so nor what the result, such as the number $89/8$, \emph{means}. Before we investigate these questions, we offer some definitions.

\begin{definition}[Iterated Integration]\label{def:iterated_integral}
\textbf{Iterated integration} is the process of repeatedly integrating the results of previous integrations. Integrating one integral is denoted as follows.\bigskip

Let $a$, $b$, $c$ and $d$ be numbers and let $g_1(x)$, $g_2(x)$, $h_1(y)$ and $h_2(y)$ be functions of $x$ and $y$, respectively. Then:
\index{integration!iterated}\index{integration!multiple}\index{iterated integration}\index{integration!notation}
\begin{enumerate}
	\item $\ds \int_c^d\int_{h_1(y)}^{h_2(y)} f(x,y)\ dx\ dy = \int_c^d\left(\int_{h_1(y)}^{h_2(y)} f(x,y)\ dx\right) dy.$
	\item $\ds \int_a^b\int_{g_1(x)}^{g_2(x)} f(x,y)\ dy\ dx = \int_a^b\left(\int_{g_1(x)}^{g_2(x)} f(x,y)\ dy\right) dx.$
\end{enumerate}
\end{definition}

Again make note of the bounds of these iterated integrals.\\
With $\ds \int_c^d\int_{h_1(y)}^{h_2(y)} f(x,y)\ dx\ dy$, $x$ varies from $h_1(y)$ to $h_2(y)$, whereas $y$ varies from $c$ to $d$. That is, the bounds of $x$ are \emph{curves}, the curves $x=h_1(y)$ and $x=h_2(y)$, whereas the bounds of $y$ are \emph{constants}, $y=c$ and $y=d$. It is useful to remember that
after integrating with respect to a variable, that variable is no longer present.
%when setting up and evaluating such iterated integrals, we integrate ``from curve to curve, then from point to point.''

We now begin to investigate \emph{why} we are interested in iterated integrals and \emph{what} they mean.

\subsection{Area of a plane region}

Consider the plane region $R$ bounded by $a\leq x\leq b$ and $g_1(x)\leq y\leq g_2(x)$, shown in \autoref{fig:iterated_intro}. We learned in \autoref{sec:ABC} that the area of $R$ is given by 
\index{integration!area}
\[\int_a^b \bigl(g_2(x)-g_1(x)\bigr)\ dx.\]

\mtable{Calculating the area of a plane region $R$ with an iterated integral.}{fig:iterated_intro}{\begin{tikzpicture}
\begin{axis}[width=1.16\marginparwidth,tick label style={font=\scriptsize},
axis y line=middle,axis x line=middle,name=myplot,axis on top,xtick=\empty,
ytick=\empty,extra x ticks={.1,.9},extra x tick labels={$a$,$b$},
ymin=-.1,ymax=1,xmin=-.1,xmax=1]
\addplot [smooth,thick, draw={\colorone},samples=40,domain=0:1] ({x},{.3*x^2+.1});
\addplot [smooth,thick, draw={\colorone},samples=40,domain=0:1]
 ({x},{.2*cos(deg(3*x))+.7});
\draw [thick,draw={\colortwo}] (axis cs: .1,0) -- (axis cs: .1,1);
\draw [thick,draw={\colortwo}] (axis cs: .9,0) -- (axis cs: .9,1);
\draw (axis cs:.5,.5) node {\scriptsize $R$};
\draw (axis cs:.55,.1) node {\scriptsize $y=g_1(x)$};
\draw (axis cs:.5,.87) node {\scriptsize $y=g_2(x)$};
\end{axis}
\node [right] at (myplot.right of origin) {\scriptsize $x$};
\node [above] at (myplot.above origin) {\scriptsize $y$};
\end{tikzpicture}}

We can  view the expression $\bigl(g_2(x)-g_1(x)\bigr)$ as 
\[
\bigl(g_2(x)-g_1(x)\bigr) = \int_{g_1(x)}^{g_2(x)} 1\ dy =\int_{g_1(x)}^{g_2(x)} \ dy,
\]
meaning we can express the area of $R$ as an iterated integral:
\[
 \text{area of }R = \int_a^b \bigl(g_2(x)-g_1(x)\bigr)\ dx
 = \int_a^b\left(\int_{g_1(x)}^{g_2(x)} \ dy\right) dx
 =\int_a^b\int_{g_1(x)}^{g_2(x)} \ dy\ dx.
\]

In short: a certain iterated integral can be viewed as giving the area of a plane region.

A region $R$ could also be defined by $c\leq y\leq d$ and $h_1(y)\leq x\leq h_2(y)$, as shown in \autoref{fig:iterated_intro2}. Using a process similar to that above, we have 
\[\text{the area of }R = \int_c^d\int_{h_1(y)}^{h_2(y)} \ dx\ dy.\]

\mtable{Calculating the area of a plane region $R$ with an iterated integral.}{fig:iterated_intro2}{\begin{tikzpicture}
\begin{axis}[width=1.16\marginparwidth,tick label style={font=\scriptsize},
axis y line=middle,axis x line=middle,name=myplot,axis on top,xtick=\empty,
ytick=\empty,extra y ticks={.1,.9},extra y tick labels={$c$,$d$},
ymin=-.1,ymax=1,xmin=-.1,xmax=1]
\addplot [smooth,thick, draw={\colorone},samples=40,domain=0:1] ({.3*x^2+.1},x);
\addplot [smooth,thick, draw={\colorone},samples=40,domain=0:1]
 ({.2*sin(deg(3*x))+.7},{x});
\draw [thick,draw={\colortwo}] (axis cs: 0,.1) -- (axis cs: 1,.1);
\draw [thick,draw={\colortwo}] (axis cs: 0,.9) -- (axis cs: 1,.9);
\draw (axis cs:.5,.5) node {\scriptsize $R$};
\draw (axis cs:.3,.25) node {\scriptsize $x=h_1(y)$};
\draw (axis cs:.68,.8) node {\scriptsize $x=h_2(y)$};
\end{axis}
\node [right] at (myplot.right of origin) {\scriptsize $x$};
\node [above] at (myplot.above origin) {\scriptsize $y$};
\end{tikzpicture}}

We state this formally in a theorem.

\begin{theorem}[Area of a plane region]\label{thm:area_plane_region}
\mbox{}\\[-2\baselineskip]\parbox[t]{\linewidth}{%
\begin{enumerate}
	\item Let $R$ be a plane region bounded by $a\leq x\leq b$ and $g_1(x)\leq y\leq g_2(x)$, where $g_1$ and $g_2$ are continuous functions on $[a,b]$. The area $A$ of $R$ is
	\[A = \int_a^b\int_{g_1(x)}^{g_2(x)} \ dy\ dx.\]
	\item Let $R$ be a plane region bounded by $c\leq y\leq d$ and $h_1(y)\leq x\leq h_2(y)$, where $h_1$ and $h_2$ are continuous functions on $[c,d]$. The area $A$ of $R$ is
	\index{integration!area}
	\[A = \int_c^d\int_{h_1(y)}^{h_2(y)} \ dx\ dy.\]
\end{enumerate}}
\end{theorem}

The following examples should help us understand this theorem.

\begin{example}[Area of a rectangle]\label{ex_iterated4}
Find the area $A$ of the rectangle with corners $(-1,1)$ and $(3,3)$, as shown in \autoref{fig:iterated4}.
\solution
Multiple integration is obviously overkill in this situation, but we proceed to establish its use.

\mtable{Calculating the area of a rectangle with an iterated integral in \autoref{ex_iterated4}.}{fig:iterated4}{\begin{tikzpicture}
\begin{axis}[width=1.16\marginparwidth,tick label style={font=\scriptsize},
axis y line=middle,axis x line=middle,name=myplot,axis on top,xtick={-1,1,2,3},
ymin=-.1,ymax=3.5,xmin=-1.5,xmax=3.5]
\draw [thick,draw={\colorone}] (axis cs: -1,1)rectangle(axis cs:3,3);
\draw (axis cs:1,2) node {$R$};
\end{axis}
\node [right] at (myplot.right of origin) {\scriptsize $x$};
\node [above] at (myplot.above origin) {\scriptsize $y$};
\end{tikzpicture}}

The region $R$ is bounded by $x=-1$, $x=3$, $y=1$ and $y=3$. Choosing to integrate with respect to $y$ first, we have 
\[
 A = \int_{-1}^3\int_1^3 1\ dy\ dx = \int_{-1}^3 \left(y\ \Big|_1^3\right)\ dx
 = \int_{-1}^3 2\ dx = 2x\Big|_{-1}^3=8.
\]

We could also integrate with respect to $x$ first, giving:
\[
 A = \int_1^3\int_{-1}^3 1\ dx \ dy =\int_1^3 \left(x\ \Big|_{-1}^3\right)\ dy
 = \int_1^3 4\ dy = 4y\Big|_1^3 = 8.
\]

Clearly there are simpler ways to find this area, but it is interesting to note that this method works.
\end{example}

\begin{example}[Area of a triangle]\label{ex_iterated5}
Find the area $A$ of the triangle with vertices at $(1,1)$, $(3,1)$ and $(5,5)$, as shown in \autoref{fig:iterated5}.
%
\mtable{Calculating the area of a triangle with iterated integrals in \autoref{ex_iterated5}.}{fig:iterated5}{\begin{tikzpicture}
\begin{axis}[width=1.16\marginparwidth,tick label style={font=\scriptsize},
axis y line=middle,axis x line=middle,name=myplot,axis on top,xtick={4,5,1,2,3},
ytick={1,2,3,4,5},ymin=-.5,ymax=5.9,xmin=-.5,xmax=5.9]
\draw [thick,draw={\colorone}] (axis cs: 1,1) -- (axis cs:3,1)
 node [pos=.5,black,below] {\scriptsize $y=1$}
 -- node [pos=.5,black,below,sloped] {\scriptsize $y=2x-5 $} (axis cs:5,5)
 -- node [black,above,pos=.5,sloped] {\scriptsize $y=x$} (axis cs:1,1);
\draw (axis cs:2.5,1.75) node {$R$};
\end{axis}
\node [right] at (myplot.right of origin) {\scriptsize $x$};
\node [above] at (myplot.above origin) {\scriptsize $y$};
\end{tikzpicture}}
\solution
The triangle is bounded by the lines as shown in the figure. Choosing to integrate with respect to $x$ first gives that $x$ is bounded by $x=y$ to $x = \frac{y+5}2$, while $y$ is bounded by $y=1$ to $y=5$. (Recall that since $x$-values increase from left to right, the leftmost curve, $x=y$, is the lower bound and the rightmost curve, $x=(y+5)/2$, is the upper bound.) The area is
\begin{align*}
A &= \int_1^5\int_{y}^{\frac{y+5}2}\ dx\ dy \\
 &= \int_1^5\left(x\ \Big|_y^{\frac{y+5}2}\right)\ dy \\
&= \int_1^5 \left(-\frac12y+\frac52\right)\ dy \\
&= \left(-\frac14y^2+\frac52y\right)\Big|_1^5\\
&=4.
\end{align*}

We can also find the area by integrating with respect to $y$ first. In this situation, though, we have two functions that act as the lower bound for the region $R$, $y=1$ and $y=2x-5$. This requires us to use two iterated integrals. Note how the $x$-bounds are different for each integral:
\begin{align*}
 A
 &= \int_1^3\int_1^x 1\ dy \ dx &&+\qquad\int_3^5\int_{2x-5}^x1\ dy\ dx\\
 &= \int_1^3\bigl(y\bigr)\Big|_1^x\ dx &&+\qquad\int_3^5\bigl(y\bigr)\Big|_{2x-5}^x\ dx\\
 &= \int_1^3\bigl(x-1\bigr)\ dx &&+\qquad\int_3^5\bigl(-x+5\bigr)\ dx \\
 &= 2 &&+\qquad2 \\
 &=4.
\end{align*}
As expected, we get the same answer both ways.  This equality will also be justified by \autoref{thm:fubini} in the next section.
\end{example}

\begin{example}[Area of a plane region]\label{ex_iterated6}
Find the area of the region enclosed by $y=2x$ and $y=x^2$, as shown in \autoref{fig:iterated6}.
%
\mtable{Calculating the area of a plane region with iterated integrals in \autoref{ex_iterated6}.}{fig:iterated6}{\begin{tikzpicture}
\begin{axis}[width=1.16\marginparwidth,tick label style={font=\scriptsize},
axis y line=middle,axis x line=middle,name=myplot,axis on top,xtick={4,5,1,2,3},
ytick={1,2,3,4,5},ymin=-.5,ymax=4.5,xmin=-.5,xmax=2.5]
\addplot [smooth,thick, draw={\colorone},samples=40,domain=0:2.5] ({x},{2*x});
\addplot [smooth,thick, draw={\colorone},samples=40,domain=0:2.5] ({x},{x^2});
\draw (axis cs:1,1.5) node {$R$};
\draw (axis cs:1,2.5) node [rotate=45] {\scriptsize $y=2x$};
\draw (axis cs:1.25,.9) node [rotate=45]  {\scriptsize $y=x^2$};
\end{axis}
\node [right] at (myplot.right of origin) {\scriptsize $x$};
\node [above] at (myplot.above origin) {\scriptsize $y$};
\end{tikzpicture}}
\solution
Once again we'll find the area of the region using both orders of integration. 

Using $dy\ dx$:
\[
\int_0^2\int_{x^2}^{2x}1\ dy \ dx = \int_0^2(2x-x^2)\ dx
= \bigl(x^2-\frac13x^3\bigr)\Big|_0^2 = \frac43.
\]

Using $dx\ dy$:
\[
\int_0^4\int_{y/2}^{\sqrt{y}} 1\ dx\ dy = \int_0^4 (\sqrt{y}-y/2)\ dy
= \left(\frac23y^{3/2} - \frac14y^2\right)\Big|_0^4 = \frac43.
\]
\end{example}

\subsection{Changing Order of Integration}

In each of the previous examples, we have been given a region $R$ and found the bounds needed to find the area of $R$ using both orders of integration. We integrated using both orders of integration to demonstrate their equality.
\index{iterated integration!changing order}

We now approach the skill of describing a region using both orders of integration from a different perspective. Instead of starting with a region and creating iterated integrals, we will start with an iterated integral and rewrite it in the other integration order. To do so, we'll need to understand the region over which we are integrating.

The simplest of all cases is when both integrals are bound by constants. The region described by these bounds is a rectangle (see \autoref{ex_iterated4}), and so:
\[\int_a^b\int_c^d 1\ dy\ dx = \int_c^d\int_a^b1\ dx\ dy.\]

When the inner integral's bounds are not constants, it is generally very useful to sketch the bounds to determine what the region we are integrating over looks like. From the sketch we can then rewrite the integral with the other order of integration.

Examples will help us develop this skill.

\begin{example}[Changing the order of integration]\label{ex_double5}
Rewrite the iterated integral $\ds \int_0^6\int_0^{x/3} 1\ dy\ dx$ with the order of integration $dx\ dy$.
\solution
We need to use the bounds of integration to determine the region we are integrating over. %Recall \autoref{idea:bounds_on_double}: the region $R$ is completely determined by these bounds, and not influenced at all by the integrand. Therefore, to rewrite the integral, we ignore the integrand.

The bounds tell us that $y$ is bounded by $0$ and $x/3$; $x$ is bounded by 0 and 6. We plot these four curves: $y=0$, $y=x/3$, $x=0$ and $x=6$ to find the region described by the bounds. \autoref{fig:double5} shows these curves, indicating that $R$ is a triangle.

\mtable{Sketching the region $R$ described by the iterated integral in \autoref{ex_double5}.}{fig:double5}{\begin{tikzpicture}
\begin{axis}[width=1.16\marginparwidth,tick label style={font=\scriptsize},
axis y line=middle,axis x line=middle,name=myplot,axis on top,
ymin=-.5,ymax=2.5,xmin=-.5,xmax=6.9]
\draw [very thick,draw={\colortwo}] (axis cs:-.5,0) -- (axis cs:6.9,0)
 (axis cs:-.5,-.1666)
 -- node [above,black,pos=.5,sloped] {\scriptsize $y=x/3$} (axis cs: 6.9, 2.3);
\draw [very thick,draw={\colorone}] (axis cs:0,-.5) -- (axis cs:0,2.5)
 (axis cs:6,-.5) -- (axis cs:6,2.5);
\draw (axis cs:4,.5) node {$R$};                                                                                                        
\end{axis}
\node [right] at (myplot.right of origin) {\scriptsize $x$};
\node [above] at (myplot.above origin) {\scriptsize $y$};
\end{tikzpicture}}

To change the order of integration, we need to consider the curves that bound the $x$-values. We see that the lower bound is $x=3y$ and the upper bound is $x=6$. The bounds on $y$ are $0$ to $2$. Thus we can rewrite the integral as 
$\ds \int_0^2\int_{3y}^6 1\ dx \ dy$.
\end{example}

\begin{example}[Changing the order of integration]\label{ex_double7}
Change the order of integration of $\ds\int_0^4\int_{y^2/4}^{(y+4)/2}1\ dx\ dy$.
\solution
We sketch the region described by the bounds to help us change the integration order. We see $x$ is bounded below and above (i.e., to the left and right) by $x=y^2/4$ and $x=(y+4)/2$ respectively, and $y$ is bounded between 0 and 4. Graphing the previous curves, we find the region $R$ to be that shown in \autoref{fig:double7}.

\mtable{Drawing the region determined by the bounds of integration in \autoref{ex_double7}.}{fig:double7}{\begin{tikzpicture}
\begin{axis}[width=1.16\marginparwidth,tick label style={font=\scriptsize},
axis y line=middle,axis x line=middle,name=myplot,axis on top,
ymin=-.5,ymax=4.5,xmin=-.5,xmax=4.5]
\addplot [smooth,very thick, draw={\colorone},samples=10,domain=-.5:4.5]({x^2/4},{x});
\addplot [smooth,very thick, draw={\colorone},samples=10,domain=-.5:4.5]({((x+4))/2},{x});
\draw [very thick,draw={\colortwo}] (axis cs:-.5,0) -- (axis cs:4.5,0)
 (axis cs:-.5,4) -- (axis cs:4.5,4);
\draw (axis cs:2,1.75) node {$R$};                                                                                                      
\draw (axis cs:2,3.1) node [rotate=30] {\scriptsize$x=y^2/4$};
\draw (axis cs:3,1.5) node [rotate=56] {\scriptsize $x= (y+4)/2$};                                                                      
\end{axis}
\node [right] at (myplot.right of origin) {\scriptsize $x$};
\node [above] at (myplot.above origin) {\scriptsize $y$};
\end{tikzpicture}}

To change the order of integration, we need to establish curves that bound $y$. The figure makes it clear that there are two lower bounds for $y$: $y=0$ on $0\leq x\leq 2$, and $y=2x-4$ on $2\leq x\leq 4$. Thus we need two double integrals. The upper bound for each is $y=2\sqrt{x}$. Thus we have
\[
\int_0^4\int_{y^2/4}^{(y+4)/2}1\ dx\ dy
= \int_0^2\int_0^{2\sqrt{x}} 1\ dy\ dx + \int_2^4\int_{2x-4}^{2\sqrt{x}}1\ dy\ dx.
\]
%Note how we did not specify the integrand, leaving it to be some function $f(x,y)$. This again stresses the point that the integrand has no bearing on the bounds of integration.
\end{example}

This section has introduced a new concept, the iterated integral. We developed one application for iterated integration: area between curves. However, this is not new, for we already know how to find areas bounded by curves.

In the next section we apply iterated integration to solve problems we currently do not know how to handle. The ``real'' goal of this section was not to learn a new way of computing area. Rather, our goal was to learn how to define a region in the plane using the bounds of an iterated integral. That skill is very important in the following sections.

\printexercises{exercises/13_01_exercises}
